<!-- 
	// Copyright (c) Cingulara LLC 2020 and Tutela LLC 2020. All rights reserved.
	// Licensed under the GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007 license. See LICENSE file in the project root for full license information.
-->
<!DOCTYPE html>
<html lang="en">
<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<title>OpenRMF - Checklist Record</title>
		<meta name="description" content="OpenRMF Checklist">
		<meta name="author" content="Dale Bingham - https://www.cingulara.com">
		<meta name="referrer" content="origin">

		<!-- Favicon -->
		<link rel="shortcut icon" href="assets/images/favicon.ico">
		<link rel="apple-touch-icon" sizes="57x57" href="assets/favicons/apple-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="assets/favicons/apple-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="assets/favicons/apple-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="assets/favicons/apple-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="assets/favicons/apple-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="assets/favicons/apple-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="assets/favicons/apple-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="assets/favicons/apple-icon-152x152.png">
		<link rel="apple-touch-icon" sizes="180x180" href="assets/favicons/apple-icon-180x180.png">
		<link rel="icon" type="image/png" sizes="192x192"  href="assets/favicons/android-icon-192x192.png">
		<link rel="icon" type="image/png" sizes="32x32" href="assets/favicons/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="assets/favicons/favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="assets/favicons/favicon-16x16.png">
		<link rel="manifest" href="assets/favicons/manifest.json">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
		<meta name="theme-color" content="#ffffff">

		<!-- Bootstrap CSS -->
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		
		<!-- Font Awesome CSS -->
		<link href="assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
		
		<!-- Custom CSS -->
		<link href="assets/css/style.css" rel="stylesheet" type="text/css" />
		<link href="assets/plugins/sweetalert/sweetalert.css" rel="stylesheet" type="text/css" />
		
		<!-- BEGIN CSS for this page -->
		<link rel="stylesheet" type="text/css" href="/assets/css/dataTables.bootstrap4.min.css"/>
		<link href="assets/css/pricing-tables.css" rel="stylesheet" type="text/css" />
		<link href="assets/plugins/jstree/style.css" rel="stylesheet" type="text/css"/>
		<link href="assets/plugins/jquery.filer/css/jquery.filer.css" rel="stylesheet" />
		<link href="assets/plugins/jquery.filer/css/themes/jquery.filer-dragdropbox-theme.css" rel="stylesheet" />
		<link href="assets/plugins/select2/css/select2.min.css" rel="stylesheet" />
		<!-- END CSS for this page -->
</head>

<body class="adminbody">
	<script src="assets/js/keycloak.min.js"></script>
	<script src="./js/auth.js"></script>
	<div id="main" style="display: none;">

		<!-- top bar navigation -->
		<div class="headerbar">

			<!-- LOGO -->
		<div class="headerbar-left">
			<a href="index.html" class="logo"><img alt="Logo" src="assets/images/logo.jpg" /> <span>Open<span>RMF</span></span></a>
		</div>

		<nav class="navbar-custom">
			<ul class="list-inline float-right mb-0">
				<li class="list-inline-item dropdown notif">
					<a class="nav-link dropdown-toggle arrow-none" data-toggle="dropdown" href="#" role="button" title="Help and Support"
						aria-haspopup="false" aria-expanded="false">
						<i class="fa fa-fw fa-question-circle"></i>
					</a>
					<div class="dropdown-menu dropdown-menu-right dropdown-arrow dropdown-arrow-success dropdown-lg">
						<!-- item-->
						<div class="dropdown-item noti-title">
							<h5><small>Help and Support</small></h5>
						</div>

						<!-- item-->
						<a target="_blank" rel="noopener noreferrer" href="/help/" class="dropdown-item notify-item">
							<p class="notify-details ml-0">
								<b>OpenRMF Online Help</b>
								<span>Systems, Checklists, Reports</span>
							</p>
						</a>
						<!-- item-->
						<a target="_blank" rel="noopener noreferrer" href="https://cingulara.github.io/openrmf-docs/" class="dropdown-item notify-item">
							<p class="notify-details ml-0">
								<b>OpenRMF install, download, SCAP, ACAS, RMF Process</b>
								<span>GitHub Pages <i class="fa fa-fw fa-external-link"></i></span>
							</p>
						</a>
					</div>
				</li>
				<li class="list-inline-item dropdown notif">
					<a class="nav-link dropdown-toggle nav-user" data-toggle="dropdown" title="Open the User Menu"
						href="#" role="button" aria-haspopup="false" aria-expanded="false">
						<img src="assets/images/avatars/avatar3.png" alt="Profile image" 
						class="avatar-rounded">
					</a>
					<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
						<!-- item-->
						<div class="dropdown-item noti-title">
							<h5 class="text-overflow"><small>Hello, <span id="profileUserName"></span></small> </h5>
						</div>

						<!-- item-->
						<a id="profileAccountURL" href="" class="dropdown-item notify-item" title="Open your Profile page">
							<i class="fa fa-user"></i> <span>Profile</span>
						</a>

						<!-- item-->
						<a id="profileLogoutURL" href="" title="Logout of OpenRMF"
							class="dropdown-item notify-item"><i class="fa fa-power-off"></i> <span>Logout</span>
						</a>
					</div>
				</li>
			</ul>
			<ul class="list-inline menu-left mb-0">
				<li class="float-left">
					<button class="button-menu-mobile open-left">
						<i class="fa fa-fw fa-bars"></i>
					</button>
				</li>                        
			</ul>
		</nav>
		</div>
		<!-- End Navigation -->

		<!-- Left Sidebar -->
		<div class="left main-sidebar">
			<div class="sidebar-inner leftscroll">
				<div id="sidebar-menu">
				<ul>
					<li class="submenu">
						<a href="index.html" title="View your OpenRMF Dashboard"><i class="fa fa-fw fa-dashboard"></i><span> Dashboard </span> </a>
					</li>
					<li class="submenu">
						<a href="systems.html" title="View your Systems and Checklists"><i class="fa fa-fw fa-table"></i><span> Systems </span> </a>
					</li>
					<li class="submenu">
						<a href="compliance.html" title="Generate your System Compliance Listing"><i class="fa fa-fw fa-check-square-o"></i><span> Compliance </span> </a>
					</li>
					<li class="submenu">
						<a href="templates.html" title="View your OpenRMF Template Checklists"><i class="fa fa-fw fa-list"></i><span> Templates </span> </a>
					</li>
					<li class="submenu">
						<a href="/reports/index.html" title="View your OpenRMF Reporting Dashboard"><i class="fa fa-fw fa-area-chart"></i><span> Reports </span> </a>
					</li>
					<li class="submenu" id="menuUpload" title="Upload New Templates or Checklists or by System" style="display: none;">
						<a href="upload.html"><i class="fa fa-fw fa-file-text-o"></i><span> Upload </span> </a>
					</li>
					<li class="submenu" id="menuAudit" title="View Audit Records" style="display: none;">
						<a href="audit.html"><i class="fa fa-fw fa-shield"></i><span> Audit </span> </a>
					</li>
					<li class="submenu" id="menuMetrics" title="View Grafana Application Metrics">
						<a style="cursor: pointer;" onclick="menuMetricsLink(); return false;"><i class="fa fa-fw fa-bar-chart"></i><span> Metrics </span> </a>
					</li>
				</ul>
				<div class="clearfix"></div>
				</div>
				<div class="clearfix"></div>
			</div>
		</div>
	<!-- End Sidebar -->
	
		<div class="content-page">	
			<!-- Start content -->
			<div class="content">            
				<div class="container-fluid">					
					<div class="row">
						<div class="col-xl-12">
							<div class="breadcrumb-holder">
								<h1 class="main-title float-left">My Checklist</h1>
								<ol class="breadcrumb float-right">
									<li class="breadcrumb-item">Home</li>
									<li class="breadcrumb-item active">Checklist</li>
								</ol>
								<div class="clearfix"></div>
							</div>
						</div>
					</div>
					<!-- end row -->
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
							<div id="divMessaging" class="alert alert-warning alert-dismissible fade show" style="display: none;" role="alert"></div>
						</div>	
					</div>
					<!-- end row -->
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
							<div class="card mb-3">
								<div class="card-header">
									<h3 class="float-left"><i class="fa fa-info-circle"></i> Asset Information</h3>
									<button type="button" id="btnReturnToChecklistListing" onclick="returnToChecklistListing();" 
										class="btn btn-info btn-sm m-r-5 m-b-10 float-right">List All Checklists</button>&nbsp;
								</div>								
								<div class="card-body">
									<div id="divMessaging" class="alert alert-warning alert-dismissible fade show" style="display: none;" role="alert"></div>
									<div id="checklistSystem"></div>
									<div id="checklistHost"></div>
									<div id="checklistSTIGTitle"></div>
									<div id="checklistSTIGVersionInfo"></div>
									<div id="checklistSTIGReleaseInfo"></div>
									<div id="checklistFQDN"></div>
									<div id="checklistTechArea"></div>
									<div id="checklistAssetType"></div>
									<div id="checklistRole"></div>
									<div id="checklistTags"></div>
									<br />
									<div class="small" id="checklistLastUpdated"></div>
								</div>
							</div><!-- end card-->
						</div>
						<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">	
							<div class="card mb-3">
								<div class="card-header">
									<h3 id="checklistTitle" class="float-left"></h3>
								</div>
								<div class="card-body">
									<div style="display: none;" id="divBadChecklistId" 
										class="alert alert-danger alert-dismissible fade show" role="alert">The Checklist ID passed in 
										(<span id="txtBadChecklistId"></span>) is not valid. Please return to the page listing the Checklist 
										and try again. If this continues please contact your application administrator.
										<button type="button" class="close" data-dismiss="alert" aria-label="Close">
										<span aria-hidden="true">&times;</span>
										</button>
									</div>
									<table class="table table-condensed table-hover table-bordered table-responsive-md">
									<thead>
										<tr>
											<th></th>
											<th class="tabco4">Open</th>
											<th class="tabco2">Not a Finding</th>
											<th class="tabco3">Not Applicable</th>
											<th class="tabco5">Not Reviewed</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>Total</td>
											<td class="tabco4 clickable" title="Filter by all Open Items" onclick="setVulnerabilityFilter('open','all'); return false;"><div id="checklistOpenCount"></div></td>
											<td class="tabco2 clickable" title="Filter by all Not a Finding Items" onclick="setVulnerabilityFilter('naf','all'); return false;"><div id="checklistNotAFindingCount"></div></td>
											<td class="tabco3 clickable" title="Filter by all Not Applicable Items" onclick="setVulnerabilityFilter('na','all'); return false;"><div id="checklistNotApplicableCount"></div></td>
											<td class="tabco5 clickable" title="Filter by all Not Reviewed Items" onclick="setVulnerabilityFilter('nr','all'); return false;"><div id="checklistNotReviewedCount"></div></td>
										</tr>
										<tr>
											<td style="text-align: right;">CAT 1</td>
											<td class="tabco4 clickable" title="Filter by all CAT 1 Open Items" onclick="setVulnerabilityFilter('open','cat1'); return false;"><div id="cat1OpenCount"></div></td>
											<td class="tabco2 clickable" title="Filter by all CAT 1 Not a Finding Items" onclick="setVulnerabilityFilter('naf','cat1'); return false;"><div id="cat1NotAFindingCount"></div></td>
											<td class="tabco3 clickable" title="Filter by all CAT 1 Not Applicable Items" onclick="setVulnerabilityFilter('na','cat1'); return false;"><div id="cat1NotApplicableCount"></div></td>
											<td class="tabco5 clickable" title="Filter by all CAT 1 Not Reviewed Items" onclick="setVulnerabilityFilter('nr','cat1'); return false;"><div id="cat1NotReviewedCount"></div></td>
										</tr>
										<tr>
											<td style="text-align: right;">CAT 2</td>
											<td class="tabco6 clickable" title="Filter by all CAT 2 Open Items" onclick="setVulnerabilityFilter('open','cat2'); return false;"></i><div id="cat2OpenCount"></div></td>
											<td class="tabco2 clickable" title="Filter by all CAT 2 Not a Finding Items" onclick="setVulnerabilityFilter('naf','cat2'); return false;"><div id="cat2NotAFindingCount"></div></td>
											<td class="tabco3 clickable" title="Filter by all CAT 2 Not Applicable Items" onclick="setVulnerabilityFilter('na','cat2'); return false;"><div id="cat2NotApplicableCount"></div></td>
											<td class="tabco5 clickable" title="Filter by all CAT 2 Not Reviewed Items" onclick="setVulnerabilityFilter('nr','cat2'); return false;"><div id="cat2NotReviewedCount"></div></td>
										</tr>
										<tr>
											<td style="text-align: right;">CAT 3</td>
											<td class="tabco7 clickable" title="Filter by all CAT 3 Open Items" onclick="setVulnerabilityFilter('open','cat3'); return false;"><div id="cat3OpenCount"></div></td>
											<td class="tabco2 clickable" title="Filter by all CAT 3 Not a Finding Items" onclick="setVulnerabilityFilter('opnafn','cat3'); return false;"><div id="cat3NotAFindingCount"></div></td>
											<td class="tabco3 clickable" title="Filter by all CAT 3 Not Applicable Items" onclick="setVulnerabilityFilter('na','cat3'); return false;"><div id="cat3NotApplicableCount"></div></td>
											<td class="tabco5 clickable" title="Filter by all CAT 3 Not Reviewed Items" onclick="setVulnerabilityFilter('nr','cat3'); return false;"><div id="cat3NotReviewedCount"></div></td>
										</tr>
										</tbody>
									</table>
									<div class="small">* Click on the numbers to filter the Vulnerabilities below</div> <br />
									<button type="button" id="btnUpdateChecklist" style="display: none;" onclick="openChecklistMetadata(); return false;" 
										class="btn btn-success btn-sm"><span class="btn-label"><i class="fa fa-edit"></i></span> Edit</button>
									<button type="button" id="btnDownloadChecklist" style="display: none;" onclick="downloadChecklistFile(getParameterByName('id'), false);" 
										class="btn btn-success btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Download</button>
									<button type="button" id="btnExportChecklist" style="display: none;" onclick="exportChecklistXLSX(getParameterByName('id'), false);" 
										class="btn btn-success btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Export</button>
									<button type="button" id="btnUploadChecklist" style="display: none;" onclick="uploadFromChecklist();" 
											class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-file-text-o"></i></span> Upload</button>
									<button type="button" id="btnDeleteChecklist" style="display: none;" onclick="deleteChecklist(getParameterByName('id'), false);" 
										class="btn btn-danger btn-sm"><span class="btn-label"><i class="fa fa-remove"></i></span> Delete</button>
								</div><!-- end card body -->
							</div><!-- end card-->
						</div>
					</div><!-- end row-->

					<div class="row" id="rowControlInformation" style="display: none;">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
							<div class="card mb-3">
								<div class="card-header">
									<h3 class="float-left"><div id="checklistControlTitle"></div></h3>
								</div>								
								<div class="card-body">
									<div id="checklistControlGuidance"></div>
								</div><!-- end card body -->															
							</div><!-- end card-->					
						</div>	
					</div><!-- end row-->

					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
							<div class="card mb-3">
								<div class="card-header">
									<h3><i class="fa fa-folder-open-o"></i> Vulnerability Filter</h3>
								</div>
								<div class="card-body">				
									<div class="row" id="divVulnFilter" style="display: none;">
										<div class="col-xl-12">
											<div>
												<div class="row">
													<div class="col-xl-6"><b>Status:</b>&nbsp;
														<input id="chkVulnNaF" type="checkbox" checked="true"> <span class="vulnNotAFindingText">Not a Finding</span>
														<input id="chkVulnOpen" type="checkbox" checked="true"> <span class="vulnOpenCAT1Text">Open</span> &nbsp;
														<input id="chkVulnNA" type="checkbox" checked="true"> <span class="vulnNotApplicableText">N/A</span> &nbsp;
														<input id="chkVulnNR" type="checkbox" checked="true"> <span class="vulnNotReviewedText">Not Reviewed</span> &nbsp;
													</div>
													<div class="col-xl-6"><b>Severity:</b>&nbsp;
														<input id="chkVulnCAT1" type="checkbox" checked="true"> High (CAT 1) &nbsp;
														<input id="chkVulnCAT2" type="checkbox" checked="true"> Medium (CAT 2) &nbsp;  
														<input id="chkVulnCAT3" type="checkbox" checked="true"> Low (CAT 3)
													</div>
												</div>
												<div class="row">
													<div class="col-xl-12"><br />
														<button id="btnSetVulnFilter" class="btn btn-primary btn-sm m-r-5 m-b-10" 
															onclick="updateVulnerabilityListingByFilter(); return false;">Apply</button>
													</div>
												</div>											
											</div>
										</div>
									</div>			
								</div>
							</div>
						</div><!-- end card-->
					</div>

					<div class="row" id="divVulnerabilities">
						<div class="col-xs-12 col-sm-12 col-md-4 col-lg-2 col-xl-2">
							<div class="card mb-3">
								<div class="card-header">
									<h3><i class="fa fa-folder-open-o"></i> Vuln Ids</h3>
								</div>
								<div class="card-body">
									<div class="row">
										<div class="col-xl-12">
											<div id="checklistTree" class="vulnListing scrollableDiv"></div>
										</div>			
									</div>
								</div>
							</div>
						</div><!-- end card-->
						<div class="col-xs-12 col-sm-12 col-md-8 col-lg-5 col-xl-5">
							<div class="card mb-3">
								<div class="card-header">
									<h3><i class="fa fa-folder-open-o"></i> Vulnerability Details</h3>
								</div>
								<div class="card-body">
									<div class="vulnListingDetail scrollableDiv">
										<div class="vulnSpacing" id="vulnId">Please select a Vulnerability ID to view its details.</div>
										<div class="vulnSpacing" id="vulnStigId"></div>
										<div class="vulnSpacing" id="vulnSeverity"></div>
										<div class="vulnSpacing" id="vulnRuleId"></div>
										<div class="vulnSpacing" id="vulnRuleName"></div>
										<div class="vulnSpacing" id="vulnRuleTitle"></div>
										<div class="vulnSpacing" id="vulnClassification"></div>
										<div class="vulnSpacing" id="vulnDiscussion"></div>
										<div class="vulnSpacing" id="vulnCheckText"></div>
										<div class="vulnSpacing" id="vulnFixText"></div>
										<div class="vulnSpacing" id="vulnCCIId"></div>
										<div class="vulnSpacing" id="vulnSeverityOverrideGuidance"></div>
									</div>
								</div>
							</div>
						</div><!-- end card-->
						<div class="col-xs-12 col-sm-12 col-md-8 col-lg-5 col-xl-5">
							<div class="card mb-3">
								<div class="card-header">
									<h3 class="float-left"><i class="fa fa-folder-open-o"></i> Status &amp; Comments</h3>
									<button id="btnSaveVulnerability" style="display: none;" type="button" class="btn btn-primary btn-sm m-r-5 m-b-10 float-right" onclick="updateSingleChecklistVulnerability(getParameterByName('id'));">Save changes</button>
								</div>
								<div class="card-body">
									<div class="vulnListingDetail scrollableDiv">
										<div id="divVulnerabilityForm" style="display: none;">
											<input type="hidden" id="frmVulnID" />
											<div class="form-group">
												<label for="frmVulnStatus">Status (required)</label>
												<select class="form-control select2" id="frmVulnStatus" readonly="readonly" disabled="disabled">
														<option value="Open">Open</option>
														<option value="NotAFinding">Not a Finding</option>
														<option value="Not_Reviewed">Not Reviewed</option>
														<option value="Not_Applicable">Not Applicable</option>
												</select>
											</div>
											<div class="form-group">
											<label for="frmVulnDetails">Finding Details</label>
											<textarea class="form-control" id="frmVulnDetails" cols="40" rows="3" readonly="readonly"
												aria-describedby="titleDetails" placeholder="Enter the Finding Details"></textarea>
											</div>
											<div class="form-group">
											<label for="frmVulnComments">Comments</label>
											<textarea class="form-control" id="frmVulnComments" cols="40" rows="3" readonly="readonly"
												aria-describedby="titleComments" placeholder="Enter any Comments"></textarea>
											</div>
											<div class="form-group">
												<label for="frmVulnSecurityOverride">Severity Override</label>
												<select class="form-control select2" id="frmVulnSecurityOverride" readonly="readonly" disabled="disabled">
														<option value="">Choose one...</option>
														<option value="high">CAT I / High</option>
														<option value="medium">CAT II / Medium</option>
														<option value="low">CAT III / Low</option>
												</select>
											</div>
											<div class="form-group">
											<label for="frmVulnSecurityJustification">Severity Override Justification</label>
											<textarea class="form-control" id="frmVulnSecurityJustification" cols="40" rows="4" readonly="readonly"
												aria-describedby="titleSecurityJustification" placeholder="Enter any Comments"></textarea>
											</div>
											<div class="form-group">
											<label for="frmBulkUpdateCheckbox">Save Information Across All Checklist Types for this Vulnerability ID?</label>
											<input type="checkbox" id="frmBulkUpdateCheckbox"  readonly="readonly" disabled="disabled" /> Yes
											<small id="titleBulkUpdate" class="form-text text-muted">Save this vulnerability information across all similar 
												checklists types in this System?</small>
											</div>
									  	</div>
									</div>
								</div>
							</div>
						</div><!-- end card-->
					</div>

					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">						
							<div class="card mb-3">
								<div class="card-header">
									<h3><i class="fa fa-table"></i> Severity Breakdown</h3>
								</div>
									
								<div class="card-body">
									<canvas id="chartSeverity"></canvas>
								</div>
								<div id="chartSeverityUpdated" class="card-footer small text-muted"></div>
								<button type="button" id="btnDownloadChartSeverity" style="display: none;" onclick="downloadChart('chartSeverity');" style="width: 200px;"
									class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Save Chart</button>
							</div><!-- end card-->					
						</div>
						
						<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">						
							<div class="card mb-3">
								<div class="card-header">
									<h3><i class="fa fa-table"></i> Category Breakdown</h3>
								</div>
									
								<div class="card-body">
									<canvas id="chartCategory"></canvas>
								</div>
								<div id="chartCategoryUpdated" class="card-footer small text-muted"></div>
								<button type="button" id="btnDownloadChartCategory" style="display: none;" onclick="downloadChart('chartCategory');" style="width: 200px;"
									class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Save Chart</button>
							</div><!-- end card-->					
						</div>							
					</div>
					
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">						
							<div class="card mb-3">
								<div class="card-header">
									<h3><i class="fa fa-table"></i> Checklist Score Breakdown</h3>
								</div>
									
								<div class="card-body">
									<canvas id="barChart"></canvas>
								</div>							
								<div id="barChartUpdated" class="card-footer small text-muted"></div>
								<button type="button" id="btnDownloadBarChart" style="display: none;"  onclick="downloadChart('barChart');" style="width: 200px;"
									class="btn btn-info btn-sm"><span class="btn-label"><i class="fa fa-download"></i></span> Save Chart</button>
							</div><!-- end card-->					
						</div>
					</div>

				</div>
				<!-- END container-fluid -->
			</div>
			<!-- END content -->
		</div>
		<!-- END content-page -->
		
		<footer class="footer"><div id="includeFooterLink"></div></footer>
		<div id="includeAutoLogin"></div>

	</div>
	<!-- END main -->

<script src="assets/js/modernizr.min.js"></script>
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/moment.min.js"></script>

<script src="assets/js/popper.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>

<script src="assets/js/detect.js"></script>
<script src="assets/js/fastclick.js"></script>
<script src="assets/js/jquery.blockUI.js"></script>
<script src="assets/js/jquery.nicescroll.js"></script>
<script src="assets/js/jquery.scrollTo.min.js"></script>
<script src="assets/plugins/switchery/switchery.min.js"></script>
<script src="assets/plugins/sweetalert/sweetalert.js"></script>
<script src="assets/plugins/select2/js/select2.min.js"></script>

<!-- App js -->
<script src="assets/js/pikeadmin.js"></script>

<!-- BEGIN Java Script for this page -->
<script src="js/moment.min.js"></script>
<script src="./js/openrmf.js"></script>
<script src="./js/apis.js"></script>
<script src="assets/plugins/chart.js/chart.min.js"></script>
<script src="assets/plugins/chart.js/chartjs-plugin-labels.min.js"></script>
<script src="assets/plugins/jquery.filer/js/jquery.filer.min.js"></script>
<script>
	$(document).ready(function() {
		// authentication first
		keycloak.init({onLoad: 'login-required' }).success(function(authenticated) {
			if (authenticated) {
				// setup the User Interface
				setupOpenRMFUI();
				// see if the upload menu should show
				verifyMenus();
				// check if they can download
				verifyDownloadSingleChecklist();
				// check if they can delete a checklist
				verifyDeleteChecklist();
				// check if they can update the checklist
				verifyUpdateChecklist();
				// calls to get the checklist data from the API
				getChecklistData(getParameterByName('id'), false);
        		getChecklistScore(getParameterByName('id'));
        
				$('#checklistFile').filer({
					limit: 1,
					maxSize: 10,
					extensions: ['ckl', 'xml'],
					changeInput: true,
					showThumbs: true,
					captions: {
						errors: {
						filesLimit: "Only {{fi-limit}} files are allowed to be uploaded at a time.",
						filesType: "Only Checklist *.CKL and SCAP scan XCCDF *.XML files can be uploaded.",
						filesSize: "{{fi-name}} is too large! Please upload a file up to {{fi-maxSize}} MB.",
						filesSizeAll: "Files you have chosen are too large! Please upload a file up to {{fi-maxSize}} MB."
						}
					}
				});

				// set the form values if they can edit
				if (canUpload()) { // fill in the values of the form
					$("#frmVulnStatus").attr('readonly',false);
					$("#frmVulnStatus").attr('disabled',false);
					$("#frmVulnDetails").attr('readonly',false);
					$("#frmVulnComments").attr('readonly',false);
					$("#frmVulnSecurityOverride").attr('readonly',false);
					$("#frmVulnSecurityOverride").attr('disabled',false);
					$("#frmVulnSecurityJustification").attr('readonly',false);
					$("#frmBulkUpdateCheckbox").attr('readonly',false);
					$("#frmBulkUpdateCheckbox").attr('disabled',false);
				}
			}
			else {
				swal("Invalid Login", "You are not logged in. Please check your setup with Keycloak.", "error");
			}
		}).error(function() {
			swal("Invalid Login", "Keycloak did not respond correctly. Please verify your Keycloak realm as well as Redirect URI and Web Origins information. (i.e. are you missing an '*' somewhere?", "error");
		});
	}); // document ready
</script>
<!-- END Java Script for this page -->

<!-- Update Modal -->
<div class="modal fade customModal" id="editChecklistMetadata" tabindex="-1" role="dialog" aria-labelledby="customModal" aria-hidden="true">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
		<div class="modal-header">
			<h5 class="modal-title" id="exampleModalLabel2">Update <span id="frmChecklistTitle"></span> Checklist</h5>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			<span aria-hidden="true">&times;</span>
			</button>
		</div>
		<div class="modal-body">
			<div class="form-group" id="divfrmChecklistSystem">
				<label for="frmChecklistSystem">System Name (required)</label>
				<select class="form-control select2" id="frmChecklistSystem">
						<option value="">Choose one...</option>
				</select>
				<small id="titleHelp" class="form-text text-muted">Select the system pacakge this checklist belongs to</small>
			</div>
			<div class="form-group">
			  <label for="frmChecklistHost">Host</label>
			  <input type="text" class="form-control" id="frmChecklistHost" maxlength="100"
			  	aria-describedby="titleHost" placeholder="Enter the Host">
			  <small id="titleHost" class="form-text text-muted">Enter the Host/Server Name for this checklist</small>
			</div>
			<div class="form-group">
			  <label for="frmChecklistFQDN">Fully Qualified Domain Name</label>
			  <input type="text" class="form-control" id="frmChecklistFQDN" maxlength="100"
			  	aria-describedby="titleFQDN" placeholder="Enter the FQDN">
			  <small id="titleFQDN" class="form-text text-muted">Enter the Fully Qualified Domain Name</small>
			</div>
			<div class="form-group">
				<label for="frmChecklistTechArea">Technology Area</label>
				<select class="form-control select2" id="frmChecklistTechArea" aria-describedby="titleTechArea" >
						<option value="">Choose one...</option>
						<option value="Application Review">Application Review</option>
						<option value="Boundary Security">Boundary Security</option>
						<option value="CDS Admin Review">CDS Admin Review</option>
						<option value="CDS Technical Review">CDS Technical Review</option>
						<option value="Database Review">Database Review</option>
						<option value="Domain Name System (DNS)">Domain Name System (DNS)</option>
						<option value="Exchange Server">Exchange Server</option>
						<option value="Host Based System Security (HBSS)">Host Based System Security (HBSS)</option>
						<option value="Internal Network">Internal Network</option>
						<option value="Mobility">Mobility</option>
						<option value="Releasable Networks (REL)">Releasable Networks (REL)</option>
						<option value="Traditional Security">Traditional Security</option>
						<option value="UNIX OS">UNIX OS</option>
						<option value="VVOIP Review">VVOIP Review</option>
						<option value="Web Review">Web Review</option>
						<option value="Windows OS">Windows OS</option>
						<option value="Other Review">Other Review</option>
				</select>
				<small id="titleTechArea" class="form-text text-muted">Select the Technology Area</small>
			</div>
			<div class="form-group">
				<label for="frmChecklistAssetType">Asset Type</label>
				<select class="form-control select2" id="frmChecklistAssetType" aria-describedby="titleAssetType" >
						<option value="Computing">Computing</option>
						<option value="Non-Computing">Non-Computing</option>
				</select>
				<small id="titleAssetType" class="form-text text-muted">Select the Asset Type</small>
			</div>
			<div class="form-group">
				<label for="frmChecklistRole">Role</label>
				<select class="form-control select2" id="frmChecklistRole" aria-describedby="titleRole" >
					<option value="None">None</option>
					<option value="Workstation">Workstation</option>
					<option value="Member Server">Member Server</option>
					<option value="Domain Controller">Domain Controller</option>
				</select>
				<small id="titleRole" class="form-text text-muted">Select the Role for this machine</small>
			</div>
			<div class="form-group">
			  <label for="multiple-select">Tags</label>
			  <select class="selectpicker form-control" style="width: 100%;" id="frmChecklistTags" multiple data-options='{"placeholder":"Add Tags Here"}'>
			  </select>
			  <small id="titleTags" class="form-text text-muted">Enter 1 or more tags, if desired</small>
			</div>
		</div>
		<div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			<button type="button" class="btn btn-primary" onclick="updateSingleChecklist(getParameterByName('id'));">Save changes</button>
		</div>
		</div>
	</div>
</div>

</body>
</html>